% !TEX root = ../fib_poly.tex

\section{Iterated monotone path polytopes}

\Guillaume{We work in the linear setting; needs to translate into affine}

\begin{definition}
	A \emph{KV system} on $\R^n$ is a family of full-rank linear maps
	\[
	\pi_\bullet = \big\{
	\R^n \xra{\pi^n_{n-1}} \R^{n-1} \xra{\pi^{n-1}_{n-2}} \dotsb \xra{\pi^3_{2}} \R^2 \xra{\pi^2_1} \R \xra{\pi^1_0} *
	\big\}
	\]
	We denote by $\pi_k$ the composition $\pi^{k+1}_{k}\cdots\pi^n_{n-1}$.
\end{definition}

\begin{lemma}
	The data of a KV system is equivalent to the data of an orthogonal basis $\{v_1,\ldots,v_n\}$ of $\R^n$ such that $\ker \pi_k= <v_n, \ldots, v_{k+1}>$ for all $k$.
	Moreover, this basis can be taken orthonormal, in which case it is unique up to signs.
\end{lemma}

\begin{proof}
	Since $\pi_{n-1}$ has full rank, its kernel is 1-dimensional.
	We can choose a (unit) vector $v_n$ such that $\ker \pi_{n-1} = <v_n>$.
	The kernel of $\pi_{n-2}$ is 2-dimensional, and contains $\ker \pi_{n-1}$, so we can choose a (unit) vector $v_{n-1}$, perpendicular to $v_n$, such that $\ker \pi_{n-2}=<v_n,v_{n-1}>$.
	Continuing in the same fashion, we obtain an ordered basis $\{v_1,\ldots, v_n\}$ of $\R^n$ such that $\ker \pi_{k}=<v_n,\ldots,v_{k+1}>$.
	In the other way around, given such a basis, one can define the projections $\pi^{k}_{k-1}$ (which are orthogonal in this case) by forgetting the last coordinate in this basis.
\end{proof}

\begin{definition}
	Let $P\subset \R^n$ be a polytope.
	A KV system is \emph{$P$-admissible} if and only if every $k$-dimensional face of $P$ is sent injectively to $\R^k$, for all $1\leq k \leq n$.
\end{definition}

\begin{proposition}
	\label{prop:P-admissible}
	A KV system is $P$-admissible if and only if for any $k$-dimensional face $F_k$ of $P$, the vector $v_k$ is not perpendicular to the line $\LinSpan(F_k) \cap \ker \pi_{k-1}$.
\end{proposition}

\begin{proof}
	Requiring $\pi_1$ to be injective on the 1-faces of $P$ is exactly asking that for every 1-face $F_1$, we have $\LinSpan(F_1)\cap \ker \pi_0=0$, which is the same as requiring that $v_1$ is not perpendicular to $\LinSpan(F_1)$.
	Note that on both sides, it is not possible that the condition for $k=2$ is satisfied while the condition for $k=1$ does not hold.
	So, supposing that this last condition holds, we have indeed that for all 2-face $F_2$ of $P$, $\LinSpan(F_2)\cap \ker \pi_1$ is a line (the dimension of $\LinSpan(F_2)\cap \ker \pi_1$ is at least 1, and if it was 2 it would mean that some 1-faces of $F_2$ are perpendicular to $v_1$).
	Requiring that $\pi_1$ is injective on 2-faces of $P$ is exactly asking that for every 2-face $F_2$ of $P$, we have $\LinSpan(F_2)\cap \ker \pi_2=0$, which is the same as requiring that $v_2$ is not perpendicular to $\LinSpan(F_2)\cap \ker \pi_1$.
	Continuing in the same fashion, we get the equivalence between the injectivity condition on both sides.
\end{proof}

\begin{definition}
	Let $\pi_\bullet$ be a KV system on $\R^n$, and let $P\subset \R^n$ be a polytope.
	A \emph{BS system} is a family of fiber polytopes defined recursively as
	\begin{align*}
		P_0 & \defeq P \\
		P_1 & \defeq \Sigma_{\pi_1}(P_0,\pi_1(P_0)) \\
		P_k & \defeq \Sigma_{\pi_k}(P_{k-1},\Sigma_{\pi^{k}_{k-1}}(P_{k-2})), \ 2 \leq k \leq n \ ,
	\end{align*}
	where $\Sigma_{\pi^{k}_{k-1}}(P_{k-2})\defeq \Sigma_{\pi^{k}_{k-1}}(\pi_k(P_{k-2}),\pi_{k-1}(P_{k-2}))$.
\end{definition}

Note that by definition of the fiber polytope, we have $P_k \subset \ker \pi_k$ and $\dim P_k = \dim P - \min\{ \dim P,k\}$ for all $0\leq k \leq n$.

In the case where $P$ is full dimensional, we have $\dim P_k = n-k$, and all the $P_k, 1 \leq k \leq n$ are made out of a projection to a 1-dimensional polytope, so they are \emph{monotone path polytopes} \cite[Theorem 5.3]{BilleraSturmfels92}.

\Guillaume{Verify the definition of MPP: do we require the bot-top property to speak of monotone path polytope?}

\Guillaume{Say that this is a flag of fiber polytopes as considered in BS94; the flag polytope here is always a line...}

Note also that in order for this definition to make sense, one needs to use crucially the functoriality of the fiber polytope construction \cite[Lemma 2.3]{BilleraSturmfels92}.

\begin{proposition}
	\label{prop:KV-BS}
	A KV system is $P$-admissible if and only if in the associated BS system, $v_k$ orients $P_{k-1}$, for all $1\leq k \leq n$.
\end{proposition}

In order to prove this, we first prove the following general lemma.

\begin{lemma} \label{lemma:orients-the-fibers}
	Let $P \xra{\pi} Q$ be a projection of polytopes.
	A vector $v$ orients the fiber polytope $\Sigma_\pi(P,Q)$ if and only if it orients every fiber $\pi^{-1}(q), q \in Q$.
\end{lemma}

\begin{proof}
	The normal fan of $\Sigma_\pi(P,Q)$ is the common refinement of the normal fans of the fibers $\pi^{-1}(q), q \in Q$ \cite[Proposition 2.2]{BilleraSturmfels94}.
	It follows that the set of directions of the edges of $\Sigma_\pi(P,Q)$ is the union of the sets of directions of the edges of $\pi^{-1}(q), q \in Q$.
	Indeed, the edge directions of $\Sigma_\pi(P,Q)$ are normal directions to the walls of $\mathcal{N}_{\Sigma_\pi(P,Q)}$, which are precisely covered by the union of the walls of $\mathcal{N}_{\pi^{-1}(q)}, q \in Q$.
\end{proof}

\begin{proof}[Proof of \cref{prop:KV-BS}]
	From the preceding lemma, we get that the lines generated by the edges of $P_{k-1}$ are exactly the lines $\LinSpan(F_k)\cap \ker \pi_{k-1}$, for $F_k$ a $k$-face of $P$.
	By \cref{prop:P-admissible}, $P$-admissibility is equivalent to requiring that $v_k$ is not perpendicular to these lines, which is then (by definition) requiring that $v_k$ orients~$P_{k-1}$.
\end{proof}

We observe that if $v$ orients $P$, then every face $F$ of $P$ has a unique vertex $\bm_v(F)$ (resp. $\tp_v(F)$) which minimizes (resp. maximizes) the scalar product $\angles{-,v}$.

\begin{definition}
	We say that $(P,v)$ possess the \emph{bot-top property} if it has a unique vertex $\bm_v(P)$ (resp. $\tp_v(P)$) which minimizes (resp. maximizes) the scalar product $\angles{-,v}$.
	We say that $(P,\{v_k\})$ possess the \emph{bot-top property} if $(P_{k-1}, v_k)$ possess it, for every $1\leq k \leq n$.
\end{definition}

Without loss of generality, we will consider from now on a full-dimensional polytope $P\subset \R^n$, i.e. such that $\dim P=n$.

\begin{proposition}
	If a polytope-basis pair $(P,\{v_k\})$ has the bot-top property, then there is an equivariant cellular map $\mathbb{G}^n \to P$.
\end{proposition}

\begin{proof}
	In the BS system associated to $\{v_k\}$, each $P_k$ is defined via the linear functional $\angles{-,v_k}$.
	We consider the BS system associated to the linear functionals
	\begin{equation} \label{eq:new-projection}
		\frac{\angles{-,v_k}-\angles{\bm_{v_k}(P_{k-1}),v_k}}{\angles{\tp_{v_k}(P_{k-1})-\bm_{v_k}(P_{k-1}),v_k}}
	\end{equation}
	where each $P_{k-1}$ is sent to the interval $I$, the vertex $\bm_{v_k}(P_{k-1})$ is sent to $0$ and $\tp_{v_k}(P_{k-1})$ is sent to $1$.
	We construct inductively a family of continuous piece-wise linear cellular maps
	\[
	\triangle_k, \triangle_k^{\op}: I^k \to P \ , 0 \leq k \leq n-1
	\]
	such that the two maps $\triangle_k$ and $\triangle_k^{\op}$ are both homotopies between $\triangle_{k-1}$ and $\triangle_{k-1}^{\op}$.
	We can also extend the construction to a $\triangle_n : I^n \to P$ which will be an homotopy between $\triangle_{n-1}$ and $\triangle_{n-1}^{\op}$.

	First, we define $\triangle_0 (*) \defeq \bm_{v_1}(P)$ and $\triangle_0^{\op} (*) \defeq \tp_{v_1}(P)$.
	Then, the vertices $\bm_{v_2}(P_1)$ and $\tp_{v_2}(P_1)$ define uniquely sections $\triangle_1, \triangle_1^\op : I \to P$ such that $\triangle_1(0)=\triangle_1^\op(0)=\bm_{v_1}(P)$ and $\triangle_1(1)=\triangle_1^\op(1)=\tp_{v_1}(P)$.
	These sections are coherent monotone paths on $P$, defined explicitly by
	\begin{align*}
		\triangle_1(x) & = \bm_{v_2}(\pi_1^{-1}(x)) \\
		\triangle_1^\op(x) & = \tp_{v_2}(\pi_1^{-1}(x))
	\end{align*}
	for $x \in I$, where $\pi_1 : P \to I$ denotes the projection with respect to the linear functional (\ref{eq:new-projection}) in the case $k=2$.
	Next, the vertices $\bm_{v_3}(P_2)$ and $\tp_{v_3}(P_2)$ define monotone paths on $P_1$ between $bm_{v_2}(P_1)$ and $\tp_{v_2}(P_1)$.
	We consider the associated (tight coherent) subdivisions of $I$, induced by $\pi_2 : P_1 \to I$.
	We denote the vertices of these subdivisions by
	\begin{align*}
		x_1 & =\pi_2(\bm_{v_2}(P_1)), x_2, \ldots, x_{p-1}, x_p=\pi_2(\tp_{v_2}(P_1)) \\
		y_1 & = \pi_2(\bm_{v_2}(P_1)), y_2, \ldots, y_{q-1}, y_q=\pi_2(\tp_{v_2}(P_1)) \ .
	\end{align*}
	All these vertices are projections of vertices of $P_1$, which in turn have associated tight coherent sections $\triangle_{x_i}: I \to P$.
	We define a map
	\[
	\triangle_2 : I \times I \to P \ ,
	\]
	where the first copy of $I$ receives the subdivision by the $x_i$, $1\leq i \leq p$, via the formula
	\[
	\triangle_2(x_i, z) \defeq \triangle_{x_i}(z) \ ,
	\]
	and on each of the cubes $[x_i,x_{i+1}]\times I$ by the formula
	\[
	\triangle_2(t,z) \defeq \left( \frac{x_{i+1}-t}{x_{i+1}-x_i} \right) \triangle_{x_i}(z) + \left( \frac{t-x_i}{x_{i+1}-x_i} \right) \triangle_{x_{i+1}}(z) \ .
	\]
	We proceed in a similar fashion to define $\triangle_2^\op$ with the $y_j$.
	Continuing in the same fashion, we define inductively the next maps
	\[
	\triangle_k, \triangle_k^\op : I \times I^{k-1} \to P \ , 3 \leq k \leq n-1 \ .
	\]
	For the last step, we observe that $P_{n-1}$ is a segment, so we can simply define
	\begin{eqnarray*}
		\triangle_n : I \times I^{n-1} & \to & P \\
		(t,z) & \mapsto & (1-t)\triangle_{n-1}(z) + t \triangle_{n-1}^\op (z) \ .
	\end{eqnarray*}
	These maps that we obtain are by construction continuous, cellular, equivariant under the action of $\Sym_2$ permuting $\triangle_k$ and $\triangle_k^\op$ (or sending $v_k$ to $-v_k$), and even piece-wise linear.
\end{proof}