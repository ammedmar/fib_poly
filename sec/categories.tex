% !TEX root = ../fib_poly.tex

\section{Higher categories}

In this section we prove a theorem of Kapranov--Voevodsky \cite[Theorem 2.3]{kapranov1991polycategory} stating that a pasting scheme structure can be constructed on any locally Morse framed polytope.

\subsection{$n$-categories}

We will consider $n$-\textit{categories} recursively defined as categories enriched in $(n-1)$-categories.
We will take the one-sorted viewpoint identifying an $n$-category $\cC$ with a set $\Mor\cC$ together with, for $i = 0,\dots n-1$, \textit{source} and \textit{target functions}
\[
s_i, t_i \colon \Mor\cC \to \Mor\cC
\]
and \textit{partial compositions}
\[
\circ_i \colon \Mor\cC \times \Mor\cC \to \Mor\cC
\]
with $a \circ_i b$ defined when $s_i a = t_i b$.
For a complete list of relations satisfied by these please consult \cite[Definition 2.1]{steiner2004omega}.

\subsection{Pasting schemes}

We quote from Kapranov--Voevodsky \cite[p.~12]{kapranov1991polycategory}
\begin{displayquote}
	Intuitively a pasting scheme is an ``algebraic expression with indeterminate elements'' which can be evaluated in an arbitrary $n$-category as soon as we have associated, in a compatible way, to the indeterminates in the expression concrete polymorphisms.
	For example,
	\begin{center}
		\input{aux/pasting}
	\end{center}
\end{displayquote}
We will work with an elaboration of the definition of pasting scheme of Kapranov--Voevodsky due to Steiner \cite{steiner2004omega}.
%what he calls an ``augmented directed complex with a strongly loop free basis.''
A \textit{pasting scheme} is a chain complex of $\Z$-modules with a basis $B$ satisfying the following ``loop free" condition:
The preorder $\leq_\N$ on $B$ defined by $a \leq_\N b$ if and only if $a \in \partial^- b$ or $b \in \partial^+ a$ makes $B$ into a poset, where for any $b \in B$ we write $\partial^\pm b$ for the set of basis elements in $\partial b$ with positive or negative coefficients.

\anibal{Augmentation and uniqueness of basis satisfied by the polytope examples.}

The "strongly loop-free" condition does not hold in general.

\begin{example}
	Consider the $3$-dimensional cross-polytope $P$, and the frame $(v_1=(1,0,-\varepsilon),v_2=(0,-1,0),v_3=(\varepsilon,0,1))$, for any small $\varepsilon >0$.
	This frame is locally Morse, but the associated pasting scheme is not strongly loop-free.
	\Guillaume{details + drawing!}
\end{example}

%Let P be a fully oriented polytope. I.e., there is a chosen orthonormal basis of the ambient space whose k-th vector projects non-trivially onto each k-face of P. Notice that each face of P is canonically fully oriented. Let CP be the graded abelian group generated by the faces of P. Define a linear map d of degree -1 sending a k-face Q to the sum of its codimension 1 faces with coefficientÂ +1 if the k-th vector is outerpointing on it (w.r.t Q) or -1 if innerpointing.
%Claim: d o d = 0
%
%Without loss of generality we prove d o d (P) = 0 with dim P = n.
%Each codimension 2 face R in P is contained in exactly two codimension 1 faces, say Q1 and Q2. If the n-vector is outer or inner pointing at both w.r.t. P, then the n-1 vector on R is inner pointing w.r.t one of them and outer pointing w.r.t. the other, which implies the coefficient of R in d o d (P) is 0.If the n vector is inner pointing in Q1 and outer pointing on Q2 w.r.t. P, then the n-1 vector is inner pointing or outer pointing on R w.r.t. both Q1 and Q2, which also implies the coefficient of R in d o d (P) is 0.

\subsection{Globularization}
\label{ss:globularization}

\Guillaume{What do we mean by piecewise linear? It has to be an affine map; also cellular!}

\begin{lemma}
	\label{l:adjunction-I}
	Let $P \to Q$ be a projection of polytopes, and let $I$ be a $1$-dimensional polytope.
	Any piecewise linear map $f \colon I \to \Sigma(P,Q)$ induces a piecewise linear map $\tilde f \colon I \times Q \to P$.
\end{lemma}

\begin{proof}
	The image of $I$ is a path, that is a sequence of vertices and edges $$w_1,e_1,w_2,e_2,\ldots,w_{k-1},e_{k-1},w_k$$ of $\Sigma(P,Q)$.
	Let us denote by $x_1=f^{-1}(w_1),\ldots, x_k=f^{-1}(w_k)$ the preimages of the vertices of this path.
	Each vertex $w_i$ defines a unique section $\gamma_{w_i} : Q \to P$ of the projection.
	We define $\tilde f (x_i, q) \defeq \gamma_{w_i}(q)$ for all $1 \leq i \leq k$, and on each cylinder $[x_i,x_{i+1}] \times Q$ we interpolate linearly
	\[
	\tilde f (t,q) \defeq \left( \frac{x_{i+1}-t}{x_{i+1}-x_i} \right) \gamma_{w_i}(q) + \left( \frac{t-x_i}{x_{i+1}-x_i} \right) \gamma_{w_{i+1}}(q) \ .
	\]
	Since any convex combination of sections is a section, for any fixed $t\in I$ this map is a section of the projection $P \to Q$.
	Moreover, since we interpolate linearly between the tight coherent sections associated to adjacent vertices of $\Sigma(P,Q)$, we obtain a piecewise linear map.
\end{proof}

We will use iteratively \cref{l:adjunction-I} to construct, for any $n$-dimensional polytope $P$ with a Morse frame $\{v_k\}$, a surjective piecewise linear map
\[
\gcube^n \to P \ .
\]
In the iterated monotone path sequence associated to $\{v_k\}$, each $P_k$ is defined via the linear functional $\angles{-,v_k}$.
We consider the iterated monotone path sequence associated to the linear functionals
\begin{equation} \label{eq:new-projection}
	\frac{\angles{-,v_k}-\angles{\bm_{v_k}(P_{k-1}),v_k}}{\angles{\tp_{v_k}(P_{k-1})-\bm_{v_k}(P_{k-1}),v_k}}
\end{equation}
where each $P_{k-1}$ is sent to the interval $\gcube$, the vertex $\bm_{v_k}(P_{k-1})$ is sent to $0$ and the vertex $\tp_{v_k}(P_{k-1})$ is sent to $1$.
Since $P_n$ is a point, there is a natural map $\Gamma_n \colon \{*\} \to P_n=\Sigma(P_{n-1},\gcube)$, which gives rise to a map $\gcube \to P_{n-1}=\Sigma(P_{n-2},\gcube)$ that we still denote by $\Gamma_n$.
This is an homotopy between $\Gamma_{n-1} \defeq \Gamma_n(0)$ et $\Gamma_{n-1}^\op \defeq \Gamma_n(1)$.
Using \cref{l:adjunction-I}, the map $\Gamma_n$ induces a map $\Gamma_{n} \colon \gcube \times \gcube \to P_{n-2}=\Sigma(P_{n-3},\gcube)$, which interpolates between the two maps $\Gamma_{n-1} \defeq \Gamma_{n}(-,0)$ and $\Gamma_{n-1}^\op \defeq \Gamma_{n}(-,1)$.
Applying \cref{l:adjunction-I} allows us to replace the restrictions $\Gamma_{n-1}$ and $\Gamma_{n-1}^\op$ with two maps $\Gamma_{n-1} \colon \gcube \times \gcube \times \{0\} \to P_{n-3}$ and $\Gamma_{n-1}^\op \colon \gcube \times \gcube \times \{1\}  \to P_{n-3}$.
The formula defining $\Gamma_{n}$ extends to a map $\Gamma_{n} \colon \gcube \times \gcube \times \gcube \to P_{n-3}$, which interpolates between $\Gamma_{n-1}$ and $\Gamma_{n-1}^\op$.
Now we can apply \cref{l:adjunction-I} to the restriction $\gcube  \times \{x_i\} \times \{0\} \to P_{n-3}$ of $\Gamma_{n-1}$ to any vertex $x_i$ in the subdivision induced by $P_{n-2} \to \gcube$ on the second factor, in order to get maps $\gcube \times \gcube \times \{x_i\} \times \{0\} \to P_{n-4}$.
The formula defining $\Gamma_{n-1}$ extends to a map $\Gamma_{n-1} \colon \gcube \times \gcube \times \gcube \times \{0\} \to P_{n-4}$, which is an homotopy between $\Gamma_{n-2} \defeq \Gamma_{n-1}(-,-,0,0)$ and $\Gamma_{n-2}^\op \defeq \Gamma_{n-1}(-,-,1,0)$.
Similarly, we get a map $\Gamma_{n-1}^\op \colon \gcube  \times \gcube \times \gcube \times \{1\} \to P_{n-4}$ which is also an homotopy between $\Gamma_{n-1}^\op(-,-,0,1)=\Gamma_{n-2}$ and $\Gamma_{n-1}^\op(-,-,1,1)=\Gamma_{n-2}^\op$.
Now, the formula defining $\Gamma_n$ extends to a map $\Gamma_n \colon \gcube^4 \to P_{n-4}$.
Continuing in the same fashion, we obtain a piecewise linear map
\[
\Gamma_n \colon \gcube^n \to P
\]
and a family of maps
\[
\Gamma_k,\Gamma_k^\op \colon \gcube^k \to P \ , 0 \leq k \leq n-1 \ ,
\]
such that for each $k$ we have
\[
\Gamma_{k}=\Gamma_n(-,\ldots,-,0,\epsilon_{k+2},\ldots, \epsilon_{n})
\text{ and }
\Gamma_{k}^\op=\Gamma_n(-,\ldots,-,1,\epsilon_{k+2},\ldots, \epsilon_{n}) \ ,
\]
where each $\epsilon_i$, $k+2\leq i \leq n$ stands for either the value $0$ or $1$.
In particular, at each stage both $\Gamma_k$ and $\Gamma_k^\op$ are homotopies between $\Gamma_{k-1}$ and $\Gamma_{k-1}^\op$.

There is an action of $(\sym_2)^{\times n}$ on the Morse frame $\{ v_k \}$, given coordinate-wise by the assignment $v_k \mapsto -v_k$.
There is an analogous action of the same group on the $n$-cube $\gcube^n$, which is given coordinate-wise by the assignment $t_k \mapsto 1-t_k$.
We claim that the assignment $\{v_k\} \mapsto (\Gamma_n \colon \gcube^n \to P)$ is equivariant with respect to the action of $(\sym_2)^{\times n}$.
Indeed, replacing $v_k$ by its opposite $-v_k$ inverts the direction of the monotone paths on $P_{k-1}$, which corresponds precisely to inverting the parametrization of $\gcube^n$ given by \cref{l:adjunction-I}.

The map $\Gamma_n$ is surjective, but definitely not injective (for example, the restriction $\Gamma_n(0,-,\ldots,-)$ is the constant map, with value $\bm_{v_1}(P)$).
We show that it can be factored through the globe $\globe^n$, in a $(\sym_2)^{\times n}$-equivariant way, giving rise to a cellular homeomorphism $\Upsilon \colon \globe^n \cong P$.
Explicitly, we define a map $\Psi \colon \gcube^n \to \globe^n$ component-wise by the formulas
\begin{align*}
	\Psi_1(t_1,\ldots,t_n) & \defeq \cos(t_1 \pi) \\
	\Psi_2(t_1,\ldots,t_n) & \defeq \sin(t_1 \pi)\cos(t_2\pi) \\
	\Psi_3(t_1,\ldots,t_n) & \defeq \sin(t_1 \pi)\sin(t_2\pi)\cos(t_3\pi) \\
	 & \vdots \\
	\Psi_{n-1}(t_1,\ldots,t_n) & \defeq \sin(t_1 \pi) \cdots \sin(t_{n-2} \pi) \cos(t_{n-1} \pi) \\
	\Psi_n(t_1,\ldots,t_n) & \defeq  \sin(t_1 \pi) \cdots \sin(t_{n-1} \pi)  (1-2t_n)\ ,
\end{align*}
such that $\Gamma_n = \Psi \Upsilon$.
There is an action of $(\sym_2)^{\times n}$ on the globe $\globe^n$ which is given component-wise by multplication by $-1$.
It is clear that the map $\Psi$ above is $(\sym_2)^{\times n}$-equivariant and cellular.
Moreover, its fibers are precisely the cells of $\gcube^n$ on which $\Gamma_n$ is constant (for example, $\Psi^{-1}(1,0,\ldots,0)=\{0\} \times \gcube^{n-1}$), i.e. it is a quotient map.
Indeed,
\Guillaume{More details}

In the case where $P$ is centrally symmetric, it is naturally endowed with an $\sym_2$ action sending a point $p \in P$ to its symmetic $r-p \in P$, where $r$ is the center of symmetry of $P$ (see \cref{ss:centrally-symmetric}).
Considering the diagonal action of $\sym_2$ on $\gcube^n$ (resp. $\globe^n$), the map $\Gamma_n$ (resp. $\Upsilon$) then becomes $\sym_2$-equivariant.
Indeed,
\Guillaume{Continue}