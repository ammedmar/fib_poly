% !TEX root = ../fib_poly.tex

\subsection{Morse properties}

\todo{@guillaume: consider saying something about toric varieties}

A vector $v \in \R^n$ is said to be \textit{Morse} on a polytope $P \subseteq \R^n$ if $P$ has a \textbf{unique} vertex $\bm_v(P)$ which minimizes the scalar product $\angles{-,v}$ and a \textbf{unique} vertex $\tp_v(P)$ which maximizes it.
We say that $v$ is \textit{locally Morse} on $P$ if it is Morse on each face of $P$.
It is easily seen that it is sufficient to verify this property only on the edges of $P$.
Although we do not use the following terminology, we mention that these properties are sometimes expressed respectively by saying that $v$ either quasi-orients or orients $P$.

\begin{remark}
	Note that $v$ is Morse with respect to $P$ if and only if both $v$ and $-v$ lie in maximal chambers of the normal fan $\mathcal{N}_P$.
	Being locally Morse is equivalent to $v$ lying in a chamber of the smallest hyperplane arrangement refining $\mathcal{N}_P$. 
	In the literature, the corresponding zonotope is called \Guillaume{Padrol-...}; we propose the term \emph{enveloping zonotope}.
\end{remark}

A framed polytope $(P, \{v_i\})$ is said to be (\textit{locally}) \textit{Morse} if for every $1 \leq k \leq n$ the vector $v_k$ is (locally) Morse on $P_{k-1}$.

\begin{lemma}
\label{l:orients-the-fibers}
	Let $P \xra{\pi} Q$ be a projection of polytopes.
	A vector $v$ is (locally) Morse on $\Sigma(P, Q)$ if and only if it is (locally) Morse on every fiber $\pi^{-1}(q), q \in Q$.
\end{lemma}

\begin{proof}
	The normal fan of $\Sigma(P,Q)$ is the common refinement of the normal fans of the fibers $\pi^{-1}(q), q \in Q$ \cite[Proposition 2.2]{BilleraSturmfels94}.
	It follows that the set of directions of the edges of $\Sigma(P,Q)$ is the union of the sets of directions of the edges of $\pi^{-1}(q), q \in Q$.
	Indeed, the edge directions of $\Sigma(P,Q)$ are directions normal to the walls of $\mathcal{N}_{\Sigma(P,Q)}$, which are precisely covered by the union of the walls of $\mathcal{N}_{\pi^{-1}(q)}, q \in Q$.
\end{proof}

\begin{theorem}
\label{t:bot-top-for-fibers}
	Let $P \xra{\pi} Q$ be a projection of polytopes, let $r$ be the barycenter of $Q$, and let $\{v_k\}$ be an orthonormal basis of $\LinSpan(\pi^{-1}(r))$.
	Then, we have that
	\[
	(\Sigma(P,Q),\{v_k\}) \text{ is (locally) Morse}
	\implies
	\forall q \in Q, \ (\pi^{-1}(q),\{v_k\}) \text{ is (locally) Morse}.
	\]
\end{theorem}

\begin{proof}
	To ease the notation, let us denote by $\Sigma$ the fiber polytope $\Sigma(P,Q)$.
	By \cref{l:orients-the-fibers}, we have that $v_1$ is (locally) Morse on $\Sigma$ if and only if it is (locally) Morse on every fiber $\pi^{-1}(q), q \in Q$.
	By the same lemma, we have that $v_2$ is (locally) Morse on $\Sigma_1$ if and only if it is (locally) Morse on any intersection of $\Sigma$ with an hyperplane orthogonal to $v_1$.
\Guillaume{To be rewritten}
	%This is equivalent to $v_2$ being (locally) Morse on the intersections of each fiber $\pi^{-1}(q)$ with any hyperplane orthogonal to $v_1$.
	%Indeed, as shown in \cite[Lemma 3.1]{BilleraSturmfels94}, refinement of normal fans is preserved by projection, and the normal fan of the intersection of $\Sigma$ with an hyperplane orthogonal to $v_1$ is the common refinement of the normal fans of the intersections of the fibers $\pi^{-1}(q), q \in Q$ with some hyperplanes orthogonal to $v_1$. \Guillaume{NO!}

	%Using again \cref{l:orients-the-fibers}, this is equivalent to $v_2$ being (locally) Morse on $\pi^{-1}(q)_1$, for each $q \in Q$.
	Continuing in the same fashion for the higher $v_k$, we get the above equivalence.
\end{proof}

The converse of \cref{t:bot-top-for-fibers} does not hold in general, see \cref{e:simplex-permuto}.

It will be convenient to express the local Morse property of a framed polytope in terms of its associated flag.

\begin{theorem}
\label{t:Morse-injectivity}
	A framed polytope with associated flag $\pi_\bullet$ is locally Morse if and only if every $k$-face of $P$ is sent injectively to $\R^k$ by $\pi_k$.
\end{theorem}

\begin{proof}
	We reformulate the injectivity condition as follows:
	a $k$-face $F_k$ of $P$ is sent injectively to $\R^k$ by $\pi_k$ if and only if the vector $v_k$ is not perpendicular to the line $\LinSpan(F_k) \cap \LinSpan(\pi_{k-1}^{-1}(r_{k-1}))$, where $r_{k-1}$ is the barycenter of $\pi_{k-1}(P)$.
	This can be seen by induction on $k$.
	Requiring $\pi_1$ to be injective on the 1-faces of $P$ is exactly asking that for every 1-face $F_1$, we have $\LinSpan(F_1)\cap \LinSpan(\pi_{1}^{-1}(r_{1}))=0$, which is the same as requiring that $v_1$ is not perpendicular to $\LinSpan(F_1)=\LinSpan(F_1)\cap \LinSpan(\pi_{0}^{-1}(*))$.
	Note that on both sides, it is not possible that the condition for $k=2$ is satisfied while the condition for $k=1$ does not hold.
	So, supposing that this last condition holds, we have indeed that for all 2-face $F_2$ of $P$, $\LinSpan(F_2)\cap \LinSpan(\pi_{1}^{-1}(r_{1}))$ is a line (the dimension of $\LinSpan(F_2)\cap \LinSpan(\pi_{1}^{-1}(r_{1}))$ is at least 1, and if it was 2 it would mean that some 1-faces of $F_2$ are perpendicular to $v_1$).
	Requiring that $\pi_2$ is injective on 2-faces of $P$ is exactly asking that for every 2-face $F_2$ of $P$, we have $\LinSpan(F_2)\cap \LinSpan(\pi_{2}^{-1}(r_{2}))=0$, which is the same as requiring that $v_2$ is not perpendicular to $\LinSpan(F_2)\cap \LinSpan(\pi_{1}^{-1}(r_{1}))$.
	Continuing in the same fashion, we get the desired equivalence.
	The conclusion then follows from the observation that the directions of the lines $\LinSpan(F_k) \cap \LinSpan(\pi_{k-1}^{-1}(r_{k-1}))$ are exactly the directions of the edges of $P_{k-1}$, for all $k$.
	This is clear for the $1$-faces of $P$.
	For a $2$-face $F_2$ of $P$, it follows from the fact that the line $\LinSpan(F_2)\cap \LinSpan(\pi_{1}^{-1}(r_{1}))$ is the intersection of $F_2$ with an hyperplane perpendicular to $v_1$.
	The proof for the higher dimensional faces is similar.
\end{proof}